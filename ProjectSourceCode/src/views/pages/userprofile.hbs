<h1>User Profile</h1>

<!-- Username Input Field -->
<label for = "username">Username: {{ username }}</label>

<!-- Form for changing username -->
<form method="POST" action="/userprofile/change-username">
    <label for="newUsername">New Username:</label>
    <input type="text" id="newUsername" name="newUsername" placeholder="Enter your new username">
    <button type="submit">Change Username</button>
</form>



{{!-- {{Profile Picture}} --}}
<label for="profilePicture">Profile Picture (use a screenshot):</label>
<input type="file" id="profilePicture" accept="image/png">

<img id="uploadedImage" src="{{profilePicture}}" alt="Uploaded Image" style="display: none; width: 100px; height: 100px; overflow: hidden; border-radius: 50%; border: 2px solid #ccc; display: flex; justify-content: center; align-items: center;">

<button onclick="uploadProfilePicture()">Upload</button>

<script>
function uploadProfilePicture() {
    var input = document.getElementById('profilePicture');
    var file = input.files[0];

    if (file) {
        if (file.type === 'image/png') {
            var reader = new FileReader();
            reader.onload = function(e) {
                var uploadedImage = document.getElementById('uploadedImage');
                uploadedImage.src = e.target.result;
                uploadedImage.style.display = 'block';

                localStorage.setItem('profilePicture', e.target.result);
            };
            reader.readAsDataURL(file);
        } else {
            alert('Please upload a PNG image.');
        }
    } else {
        alert('Please select a file to upload.');
    }
}

window.addEventListener('DOMContentLoaded', function() {
    var uploadedImage = document.getElementById('uploadedImage');
    if (localStorage.getItem('profilePicture')) {
        uploadedImage.src = localStorage.getItem('profilePicture');
        uploadedImage.style.display = 'block';
    }
});
</script>



{{!-- {{Bio/About Me}} --}}
<label for="AboutMe">About Me:</label>
<textarea id="AboutMe" name="About Me" placeholder="Write something about yourself">{{aboutMe}}</textarea>

<button onclick="publishAboutMe()">Publish</button>

<script>
function publishAboutMe() {
    var aboutMeContent = document.getElementById('AboutMe').value;
    localStorage.setItem('aboutMeText', aboutMeContent);
}

window.addEventListener('DOMContentLoaded', function() {
    var aboutMeTextarea = document.getElementById('AboutMe');
    if (localStorage.getItem('aboutMeText')) {
        aboutMeTextarea.value = localStorage.getItem('aboutMeText');
    }
});
</script>


















{{!-- {{Previous Recommendations}} --}}
<script>
    // Function to fetch and display user's previous recommendations
    function fetchAndDisplayRecommendations() {
        // Fetch user's previous recommendations from the database
        fetch('/pages/recommendations')
            .then(response => response.json())
            .then(data => {
                // Display recommendations
                const previousRecommendations = document.getElementById('previousRecommendations');
                data.forEach(recommendation => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${recommendation.track_name} by ${recommendation.artist_name}`;
                    previousRecommendations.appendChild(listItem);
                });
            })
            .catch(error => {
                console.error('Error fetching recommendations:', error);
            });
    }

    // Call fetchAndDisplayRecommendations function when the page loads
    window.addEventListener('DOMContentLoaded', fetchAndDisplayRecommendations);
</script>

{{!-- {{Settings}} --}}
    {{!-- {{Filter Recommendations}} --}}